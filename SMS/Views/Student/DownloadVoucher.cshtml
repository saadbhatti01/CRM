
@{
    Layout = null;
}
@{
    var s = TempData["Voucher"] as SMS.Models.StdFeePkg;
    var std = TempData["Std"] as SMS.Models.Student;
    var student = TempData["Student"] as SMS.Models.Student;
}
<!DOCTYPE html>

<html>
<head>
    
    <meta name="viewport" content="width=device-width" />
    <title>Download Fee Voucher</title>
</head>
<body>
    @if (s != null && student != null)
    {
        <div>
            <input type="button" class="btn btn-success" value="Print Report" onclick="print1()" />
        </div>
        <div id="Print">
            <div class="card-title">
                @if (Session["InsName"] != null)
                {
                    <p>
                        <img src="@Session["InsImage"]" width="65" height="65" style="float:left;" />
                        <h2 style="text-align: center;">@Session["InsName"]</h2>
                        <h3 style="text-align: center;"> Student Fee Voucher</h3>
                    </p>
                }
            </div>
            <table>
                <caption>Student Copy</caption>
                <thead>
                    <tr>
                        <th colspan="3">Fee Month: @DateTime.Now.ToString("MMM-yyyy")</th>
                        <th>Voucher Print Date:<br /> @DateTime.Now.ToString("dd-MMM-yyyy") </th>
                        <th>Voucher Due Date: <br /> @TempData["Due"]</th>
                    </tr>
                    <tr>
                        <td colspan="3">Student Name: <strong> @student.pr.perName</strong> <br> Roll Number:&nbsp;&nbsp;&nbsp; <strong> @student.stdRollNo</strong> </td>
                        <td> Father Name: <strong>@student.pr.perGarName</strong><br> Contact #:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <strong> @student.pr.perContactOne </strong></td>
                        <td> Session: <strong>@student.ses.sesName</strong><br> Class:&nbsp;&nbsp;&nbsp; <strong> @student.cls.classname </strong><br> Section:  <strong> @student.sec.secName</strong> </td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th>Fee</th>
                        <th>Status</th>
                        <th>Total Fee /Rs. </th>
                        <th>Discount /Rs. </th>
                        <th>Payable Fee /Rs. </th>
                    </tr>
                    <tr>
                        <td>@s.ft.feeTypeName</td>
                        <td>UnPaid</td>
                        <td>@Convert.ToDecimal(@TempData["TotalFee"]).ToString("#,##0.00")  </td>
                        <td>@Convert.ToDecimal(s.sfpDis).ToString("#,##0.00") </td>
                        <td>@Convert.ToDecimal(s.sfpAmt).ToString("#,##0.00")  </td>
                    </tr>
                    @*<tr>
                <td>Staples (box)</td> <td>100</td> <td>1.00</td>
                <td>100.00</td> </tr>*@
                </tbody>
                <tfoot>
                    <tr>
                        <th colspan="4">Total Payable Amount /Rs.</th>
                        <td> @Convert.ToDecimal(@s.sfpAmt).ToString("#,##0.00") </td>
                    </tr> @*<tr> <th colspan="2">Tax</th> <td> 8% </td>
                <td>8.80</td> </tr> <tr> <th colspan="3">Grand Total</th> <td>$ 118.80</td> </tr>*@
                </tfoot>
            </table>
            <br />
            @*<div id="scissors"></div>*@
            <hr style="border-top: dotted 1px;" />
            <table>
                <caption>Institute Copy</caption>
                <thead>
                    <tr>
                        <th colspan="3">Fee Month: @DateTime.Now.ToString("MMM-yyyy")</th>
                        <th>Voucher Print Date:<br /> @DateTime.Now.ToString("dd-MMM-yyyy") </th>
                        <th>Voucher Due Date: <br /> @TempData["Due"]</th>
                    </tr>
                    <tr>
                        <td colspan="3">Student Name: <strong> @student.pr.perName</strong> <br> Roll Number:&nbsp;&nbsp;&nbsp; <strong> @student.stdRollNo</strong> </td>
                        <td> Father Name: <strong>@student.pr.perGarName</strong><br> Contact #:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <strong> @student.pr.perContactOne </strong></td>
                        <td> Session: <strong>@student.ses.sesName</strong><br> Class:&nbsp;&nbsp;&nbsp; <strong> @student.cls.classname </strong><br> Section:  <strong> @student.sec.secName</strong> </td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th>Fee</th>
                        <th>Status</th>
                        <th>Total Fee /Rs. </th>
                        <th>Discount /Rs. </th>
                        <th>Payable Fee /Rs. </th>
                    </tr>
                    <tr>
                        <td>@s.ft.feeTypeName</td>
                        <td>UnPaid</td>
                        <td>@Convert.ToDecimal(@TempData["TotalFee"]).ToString("#,##0.00")  </td>
                        <td>@Convert.ToDecimal(s.sfpDis).ToString("#,##0.00") </td>
                        <td>@Convert.ToDecimal(s.sfpAmt).ToString("#,##0.00")  </td>
                    </tr>
                    @*<tr>
                <td>Staples (box)</td> <td>100</td> <td>1.00</td>
                <td>100.00</td> </tr>*@
                </tbody>
                <tfoot>
                    <tr>
                        <th colspan="4">Total Payable Amount /Rs.</th>
                        <td> @Convert.ToDecimal(@s.sfpAmt).ToString("#,##0.00") </td>
                    </tr> @*<tr> <th colspan="2">Tax</th> <td> 8% </td>
                <td>8.80</td> </tr> <tr> <th colspan="3">Grand Total</th> <td>$ 118.80</td> </tr>*@
                </tfoot>
            </table>
        </div>
    }
    @if (std != null)
    {
        double Total = 0;
        double TotalDis = 0;
        double TotalFee = 0;
        double Total1 = 0;
        double TotalDis1 = 0;
        double TotalFee1= 0;
        <div>
            <input type="button" class="btn btn-success" value="Print Report" onclick="print1()" />
        </div>
        <div id="Print">
            <div class="card-title">
                @if (Session["InsName"] != null)
                {
                    <p>
                        <img src="@Session["InsImage"]" width="65" height="65" style="float:left;"/>
                        <h2 style="text-align: center;">@Session["InsName"]</h2>
                        <h3 style="text-align: center;"> Student Fee Voucher</h3>
                    </p>
                }
            </div>

            @if (TempData["AllVoucher"] != null)
            {
                <table>
                    <caption>Student Copy</caption>
                    <thead>
                        <tr>
                            <th colspan="3">Fee Month: @TempData["FeeMonth"]</th>
                            <th>Voucher Print Date:<br /> @DateTime.Now.ToString("dd-MMM-yyyy") </th>
                            <th>Voucher Due Date: <br /> @TempData["Due"]</th>
                        </tr>
                        <tr>
                            <td colspan="3">Student Name: <strong> @std.pr.perName</strong> <br> Roll Number:&nbsp;&nbsp;&nbsp; <strong> @std.stdRollNo</strong> </td>
                            <td> Father Name: <strong>@std.pr.perGarName</strong><br> Contact #:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <strong> @std.pr.perContactOne </strong></td>
                            <td> Session: <strong>@std.ses.sesName</strong><br> Class:&nbsp;&nbsp;&nbsp; <strong> @std.cls.classname </strong><br> Section:  <strong> @std.sec.secName</strong> </td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Fee</th>
                            <th>Status</th>
                            <th>Total Fee /Rs. </th>
                            <th>Discount /Rs. </th>
                            <th>Payable Fee /Rs. </th>
                        </tr>
                        @foreach (var i in (List<SMS.Models.StdFeeDetail>)TempData["AllVoucher"])
                        {
                            <tr>
                                <td>@i.Fee</td>
                                <td>UnPaid</td>
                                <td>@Convert.ToDecimal(i.TotalFee).ToString("#,##0.00")  </td>
                                <td>@Convert.ToDecimal(i.Dis).ToString("#,##0.00") </td>
                                <td>@Convert.ToDecimal(i.FeeAmt).ToString("#,##0.00")  </td>

                            </tr>
                            TotalFee = TotalFee + i.FeeAmt;
                            TotalDis = TotalDis + i.Dis;
                            Total = Total + i.TotalFee;
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <th colspan="2">Total /Rs.</th>
                            <td>@Convert.ToDecimal(@Total).ToString("#,##0.00") </td>
                            <td>@Convert.ToDecimal(@TotalDis).ToString("#,##0.00") </td>
                            <td>@Convert.ToDecimal(@TotalFee).ToString("#,##0.00") </td>
                        </tr>
                    </tfoot>
                </table>
                <hr style="border-top: dotted 1px;" />

                <table>
                    <caption>Institute Copy</caption>
                    <thead>
                        <tr>
                            <th colspan="3">Fee Month: @TempData["FeeMonth"]</th>
                            <th>Voucher Print Date:<br /> @DateTime.Now.ToString("dd-MMM-yyyy") </th>
                            <th>Voucher Due Date: <br /> @TempData["Due"]</th>
                        </tr>
                        <tr>
                            <td colspan="3">Student Name: <strong> @std.pr.perName</strong> <br> Roll Number:&nbsp;&nbsp;&nbsp; <strong> @std.stdRollNo</strong> </td>
                            <td> Father Name: <strong>@std.pr.perGarName</strong><br> Contact #:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <strong> @std.pr.perContactOne </strong></td>
                            <td> Session: <strong>@std.ses.sesName</strong><br> Class:&nbsp;&nbsp;&nbsp; <strong> @std.cls.classname </strong><br> Section:  <strong> @std.sec.secName</strong> </td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Fee</th>
                            <th>Status</th>
                            <th>Total Fee /Rs. </th>
                            <th>Discount /Rs. </th>
                            <th>Payable Fee /Rs. </th>
                        </tr>
                        @foreach (var i in (List<SMS.Models.StdFeeDetail>)TempData["AllVoucher"])
                        {
                            <tr>
                                <td>@i.Fee</td>
                                <td>UnPaid</td>
                                <td>@Convert.ToDecimal(i.TotalFee).ToString("#,##0.00")  </td>
                                <td>@Convert.ToDecimal(i.Dis).ToString("#,##0.00") </td>
                                <td>@Convert.ToDecimal(i.FeeAmt).ToString("#,##0.00")  </td>

                            </tr>
                            TotalFee1 = TotalFee1 + i.FeeAmt;
                            TotalDis1 = TotalDis1 + i.Dis;
                            Total1 = Total1 + i.TotalFee;
                        }
                    </tbody>
                    <tfoot>
                        <tr>
                            <th colspan="2">Total /Rs.</th>
                            <td>@Convert.ToDecimal(@Total1).ToString("#,##0.00") </td>
                            <td>@Convert.ToDecimal(@TotalDis1).ToString("#,##0.00") </td>
                            <td>@Convert.ToDecimal(@TotalFee1).ToString("#,##0.00") </td>
                        </tr>
                    </tfoot>
                </table>
            }

        </div>
    }
    <script type="text/javascript">
        function print1() {
            var prtContent = document.getElementById('Print');
            var mywindow = window.open('', '', 'height=700,width=900');
            mywindow.document.write('<html><head>');
            mywindow.document.write('<link href = "/Content/bootstrap.min.css" rel = "stylesheet" />')
            mywindow.document.write('<link href = "/Content/Print.css" rel = "stylesheet" />')
            mywindow.document.write('</head><body>');
            mywindow.document.write(prtContent.innerHTML);
            mywindow.document.write('</body></html>');
            mywindow.document.close();
            setTimeout(function () {
                mywindow.print();
                mywindow.close();
            }, 500)

        }
    </script>
        
    <script>

        

        window.onload = print1();
            //function load() {
            //    print1();
            //}
    </script>


</body>
</html>
